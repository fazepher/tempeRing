<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Log-density, density and random generation of a multivariate tempered normal
with inverse temperature equal to beta, mean equal to mu and covariance matrix
equal to sigma.
lmvtnorm, dmvtnorm and rmvtnorm are equivalent to the tempered versions with beta=1."><title>Multivariate Tempered Normal log densities and sampler — lmvtnorm_temp • tempeRing</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate Tempered Normal log densities and sampler — lmvtnorm_temp"><meta property="og:description" content="Log-density, density and random generation of a multivariate tempered normal
with inverse temperature equal to beta, mean equal to mu and covariance matrix
equal to sigma.
lmvtnorm, dmvtnorm and rmvtnorm are equivalent to the tempered versions with beta=1."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tempeRing</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Invariant_Kernels.html">Invariant Kernels</a>
    <a class="dropdown-item" href="../articles/Measure_Theory.html">Basic Measure Theory Preliminaries</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/fazepher/tempeRing/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multivariate Tempered Normal log densities and sampler</h1>
      <small class="dont-index">Source: <a href="https://github.com/fazepher/tempeRing/blob/HEAD/R/Distributions.R" class="external-link"><code>R/Distributions.R</code></a></small>
      <div class="d-none name"><code>lmvtnorm_temp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Log-density, density and random generation of a multivariate tempered normal
with inverse temperature equal to <code>beta</code>, mean equal to <code>mu</code> and <strong>covariance</strong> matrix
equal to <code>sigma</code>.</p>
<p><code>lmvtnorm</code>, <code>dmvtnorm</code> and <code>rmvtnorm</code> are equivalent to the tempered versions with <code>beta</code>=1.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lmvtnorm_temp</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma_inv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logdet_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dmvtnorm_temp</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma_inv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logdet_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rmvtnorm_temp</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  LChol_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  d <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lmvtnorm</span><span class="op">(</span><span class="va">x</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="cn">NULL</span>, sigma_inv <span class="op">=</span> <span class="cn">NULL</span>, logdet_sigma <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dmvtnorm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma_inv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logdet_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rmvtnorm</span><span class="op">(</span><span class="va">n</span>, mu <span class="op">=</span> <span class="fl">0</span>, sigma <span class="op">=</span> <span class="cn">NULL</span>, LChol_sigma <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A quantile vector or a matrix of quantile vectors (by rows).</p></dd>


<dt>beta</dt>
<dd><p>Inverse temperature parameter \(\beta &gt; 0\).</p></dd>


<dt>mu</dt>
<dd><p>Mean vector. If a single value is provided, it is expanded via <code>rep(mu,d)</code>.</p></dd>


<dt>sigma</dt>
<dd><p>Covariance matrix, by default it is taken to be the identity.</p></dd>


<dt>sigma_inv</dt>
<dd><p>(Optional) Inverse of the covariance matrix, see Details.</p></dd>


<dt>logdet_sigma</dt>
<dd><p>(Optional) Logarithm of the determinant of the covariance matrix, see Details.</p></dd>


<dt>d</dt>
<dd><p>Dimension of <code>x</code>, if NULL (the default) it is taken to be <code>ncol(x)</code> or <code>length(x)</code>
as appropriate;  for random generation, it would be taken as <code>length(mu)</code>.</p></dd>


<dt>log</dt>
<dd><p>For <code>dmvtnorm_temp</code> and <code>dmvtnorm</code>, whether to return the log-density or not (the default).</p></dd>


<dt>n</dt>
<dd><p>Number of observations.</p></dd>


<dt>LChol_sigma</dt>
<dd><p>(Optional) Lower triangular component of the Cholesky decomposition of <code>sigma</code>,
see Details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The preffix <code>l</code> stands for log-density, <code>d</code> for density, and <code>r</code> for sampling.
<code>lnorm</code> gives the log-density of a regular normal without tempering (i.e. \(\beta = 1\)).
See <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">stats::dnorm()</a></code> for more information. When sampling <code>n</code>&gt; 1 realizations,
the resulting matrix has <code>n</code> rows and <code>d</code> columns.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Tempering a distribution means raising its density to a power \(\beta&gt;0\),
known as inverse temperature. Equivalently, we multiply the log-density by \(\beta\):
$$f_\beta(x) = f(x)^\beta$$
$$l_\beta(x) = \beta l(x)$$
Consider a \(d\)-dimensional multivariate normal random variable centered at \(\mu\) with
covariance matrix \(\Sigma\), where \(cte\) represents the the normalizing constant
$$X ~ MVN(\mu, \Sigma)$$
$$l(x) = -0.5(x-\mu)^T\Sigma^-1(x-\mu) + cte$$
Its tempered version is equivalent to rescaling with new covariance matrix \(\Sigma/\beta\)
and keeping the same mean parameter:
$$l_\beta(x) = -\beta 0.5 (x-\mu)^T \Sigma^-1 (x-\mu)  + cte' $$
$$l_\beta(x) = -0.5 (x-\mu)^T (\Sigma/\beta)^-1 (x-\mu) + cte'$$
$$X|\beta ~ MVN(\mu, \Sigma/\beta)$$</p>
<p>Now, the multivariate normal density only depends on \(\Sigma\) through its inverse
\(\Sigma^-1\) in the kernel term and determinant in the normalizing constant
$$cte = -0.5(d log(2\pi) + log( det(\Sigma) )$$
For this reason, instead of providing the covariance matrix <code>sigma</code>, the user can provide both via
<code>sigma_inv</code> and <code>logdet_sigma</code>, saving the functions the need to compute them under the hood.</p>
<p>Another way of thinking of a Multivariate Normal random variable is to consider a Cholesky
decomposition of \(\Sigma = LL^T\), whose lower triangular component \(L\) acts as
a linear transformation of \(d\) independent univariate standard normal variables in a vector
$$X = \mu + L [z_1, ..., z_d]^T$$
This is the way <code>rmvtnorm_temp</code> and <code>rmvtnorm</code> generate samples, via <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">stats::rnorm</a></code>.
Thus, if known, the user may provide <code>LChol_sigma</code> instead of <code>sigma</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Sigma_inv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">LogDet_Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/det.html" class="external-link">det</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">lmvtnorm_temp</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, beta <span class="op">=</span> <span class="fl">0.5</span>, sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.387183</span>
<span class="r-in"><span><span class="fu">lmvtnorm_temp</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, beta <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>              sigma_inv <span class="op">=</span> <span class="va">Sigma_inv</span>, logdet_sigma <span class="op">=</span> <span class="va">LogDet_Sigma</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.387183</span>
<span class="r-in"><span><span class="fu">lmvtnorm</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.387183</span>
<span class="r-in"><span><span class="fu">dmvtnorm</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">/</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.387183</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">Sigma</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">rmvtnorm_temp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, sigma <span class="op">=</span> <span class="va">Sigma</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lmvtnorm_temp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">rmvtnorm_temp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, LChol_sigma <span class="op">=</span> <span class="va">L</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="lmvtnorm_temp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">rmvtnorm_temp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5.531046 3.141856 5.373255</span>
<span class="r-in"><span><span class="fu">rmvtnorm_temp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5.617120 5.376406 5.032025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 6.340766 5.057586 3.008333</span>
<span class="r-in"><span><span class="fu">rmvtnorm_temp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, mu <span class="op">=</span> <span class="fl">5</span>, d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          [,1]     [,2]     [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 5.458300 3.321567 4.902811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 5.975435 5.677804 5.536171</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Fernando A. Zepeda Herrera.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

